(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1490:function(e,t,r){Promise.resolve().then(r.bind(r,5882))},5882:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return P}});var n=r(7437),s=r(29),a=r.n(s),o=r(2265),i=r(5677),c=r(2489),l=r(8293),d=r(9397),u=r(1047),f=r(7053),x=r(7712),h=r(4508);let p=(0,x.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),m=o.forwardRef((e,t)=>{let{className:r,variant:s,size:a,asChild:o=!1,...i}=e,c=o?f.g7:"button";return(0,n.jsx)(c,{className:(0,h.cn)(p({variant:s,size:a,className:r})),ref:t,...i})});m.displayName="Button";var g=r(6070),v=r(7715),w=r(653);let y=o.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(v.fC,{ref:t,className:(0,h.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...s,children:(0,n.jsx)(v.z$,{className:(0,h.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(w.nQG,{className:"h-4 w-4"})})})});y.displayName=v.fC.displayName;let j=o.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,h.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});j.displayName="Input";var b=r(6815);let N=[{id:"Server1",os:"Linux",type:"server"},{id:"Server2",os:"Windows",type:"server"},{id:"Server3",os:"Linux",type:"server"},{id:"Client1",os:"Windows",type:"client"},{id:"Client2",os:"Linux",type:"client"},{id:"Client3",os:"Unknown",type:"client"},{id:"Router1",os:"Unknown",type:"network"},{id:"Switch1",os:"Unknown",type:"network"}],k=[{id:"Conn1",protocol:"HTTP",sourcePort:80,targetPort:8080,description:"Web Traffic"},{id:"Conn2",protocol:"SSH",sourcePort:22,targetPort:22,description:"Secure Shell"},{id:"Conn3",protocol:"FTP",sourcePort:21,targetPort:21,description:"File Transfer"},{id:"Conn4",protocol:"SMTP",sourcePort:25,targetPort:25,description:"Email"},{id:"Conn5",protocol:"DNS",sourcePort:53,targetPort:53,description:"Domain Name System"}],C=[{source:"Client1",target:"Server1",connection:"Conn1"},{source:"Client2",target:"Server2",connection:"Conn2"},{source:"Client3",target:"Server3",connection:"Conn3"},{source:"Server1",target:"Server2",connection:"Conn4"},{source:"Server2",target:"Server3",connection:"Conn5"},{source:"Client1",target:"Router1",connection:"Conn1"},{source:"Router1",target:"Switch1",connection:"Conn1"},{source:"Switch1",target:"Server1",connection:"Conn1"}],S=()=>{let e=(0,o.useRef)(null),[t,r]=(0,o.useState)({nodes:[],connections:[],links:[]}),[s,f]=(0,o.useState)(!1),[x,h]=(0,o.useState)([]),[p,v]=(0,o.useState)("");(0,o.useEffect)(()=>{w()},[]);let w=async()=>{try{let e=await fetch("/api/graph-data");if(!e.ok)throw Error("Failed to fetch graph data");let t=await e.json();r(t)}catch(e){console.error("Error fetching graph data:",e)}};(0,o.useEffect)(()=>{if(!t.nodes.length)return;let r={Linux:"/static/assets/Linux.svg",Windows:"/static/assets/Windows.svg",Unknown:"/static/assets/Unknown.svg"},n=e=>r[e.os]||r.Unknown,s=window.innerWidth,a=window.innerHeight,o=i.Ys(e.current).append("svg").attr("width",s).attr("height",a),c=o.append("g"),l=i.sPX().scaleExtent([.1,4]).on("zoom",e=>{c.attr("transform",e.transform.toString())});o.call(l);let d=c.append("g").attr("class","links"),u=c.append("g").attr("class","nodes"),f=c.append("g").attr("class","connections"),x=[...t.nodes,...t.connections],h=i.A4v(x).force("link",i.Fsl(t.links).id(e=>e.id).distance(150)).force("charge",i.q5i().strength(-800)).force("center",i.wqt(s/2,a/2)).force("collision",i.Hh().radius(60)),p=i.ohM().on("start",function(e,t){e.active||h.alphaTarget(.3).restart(),t.fx=e.x,t.fy=e.y}).on("drag",function(e,t){t.fx=e.x,t.fy=e.y}).on("end",function(e,t){e.active||h.alphaTarget(0),t.fx=null,t.fy=null});return(()=>{let e=d.selectAll(".link").data(t.links).join("line").attr("class","link").attr("stroke","#4A4A4A").attr("stroke-width",2),r=u.selectAll(".node").data(t.nodes).join("g").attr("class","node").call(p);r.selectAll("image").data(e=>[e]).join("image").attr("xlink:href",e=>n(e)).attr("width",32).attr("height",32).attr("x",-16).attr("y",-16),r.selectAll("text").data(e=>[e]).join("text").text(e=>e.id).attr("font-size",10).attr("dx",20).attr("dy",4);let s=f.selectAll(".connection").data(t.connections).join("g").attr("class","connection").call(p);s.selectAll("circle").data(e=>[e]).join("circle").attr("r",15).attr("class","connection-node"),s.selectAll("text").data(e=>[e]).join("text").text(e=>e.protocol).attr("font-size",8).attr("text-anchor","middle").attr("dy",-20),s.selectAll(".port-text").data(e=>[e]).join("text").attr("class","port-text").text(e=>"".concat(e.sourcePort,"->").concat(e.targetPort)).attr("font-size",8).attr("text-anchor","middle").attr("dy",20),h.nodes(x).on("tick",()=>{e.attr("x1",e=>e.source.x).attr("y1",e=>e.source.y).attr("x2",e=>{let t=e.source,r=e.target,n=r.x-t.x,s=r.y-t.y;return r.x-n*(("protocol"in r?15:16)+10)/Math.sqrt(n*n+s*s)}).attr("y2",e=>{let t=e.source,r=e.target,n=r.x-t.x,s=r.y-t.y;return r.y-s*(("protocol"in r?15:16)+10)/Math.sqrt(n*n+s*s)}),r.attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")")),s.attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")"))}),h.force("link",i.Fsl(t.links).id(e=>e.id).distance(150))})(),h.alpha(1).restart(),()=>{o.remove()}},[t]);let S=()=>{f(!s)},P=t=>{let r=i.Ys(e.current).select("svg"),n=r.node();if(n){let e=n.clientWidth,s=n.clientHeight,a=e/2,o=s/2,c=i.P2S(n),l="in"===t?1.2:.8,d=c.translate(a-l*a,o-l*o).scale(l);r.select("g").transition().duration(300).attr("transform",d.toString())}};return(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 absolute inset-0 bg-[#1a202c] overflow-hidden",children:[(0,n.jsx)("div",{id:"graph",ref:e,className:"jsx-869851c74c19e9a9 w-full h-full"}),"                ",(0,n.jsx)("div",{id:"graph",ref:e,className:"jsx-869851c74c19e9a9 absolute inset-0"}),(0,n.jsxs)(g.Zb,{className:"fixed top-0 left-0 h-full w-64 shadow-lg transition-transform duration-300 ease-in-out z-50 ".concat(s?"translate-x-0":"-translate-x-full"),children:[(0,n.jsxs)(g.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,n.jsx)(g.ll,{className:"text-sm font-medium",children:"Filters"}),(0,n.jsx)(m,{variant:"ghost",size:"icon",onClick:S,className:"h-8 w-8 p-0",children:(0,n.jsx)(c.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(g.aY,{children:(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 space-y-4",children:[(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 space-y-2",children:[(0,n.jsx)(b.Label,{children:"Node Types"}),["server","client","network"].map(e=>(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 flex items-center space-x-2",children:[(0,n.jsx)(y,{id:e,checked:x.includes(e),onCheckedChange:t=>{h(r=>t?[...r,e]:r.filter(t=>t!==e))}}),(0,n.jsx)(b.Label,{htmlFor:e,children:e.charAt(0).toUpperCase()+e.slice(1)})]},e))]}),(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 space-y-2",children:[(0,n.jsx)(b.Label,{htmlFor:"regexFilter",children:"Regex Filter"}),(0,n.jsx)(j,{id:"regexFilter",placeholder:"Enter regex...",value:p,onChange:e=>v(e.target.value)})]}),(0,n.jsx)(m,{onClick:()=>{let e=N;if(x.length>0&&(e=e.filter(e=>x.includes(e.type))),p){let t=new RegExp(p);e=e.filter(e=>t.test(e.id))}let t=C.filter(t=>e.some(e=>e.id===t.source)&&e.some(e=>e.id===t.target));r({nodes:e,connections:k,links:t.flatMap(e=>[{source:e.source,target:e.connection},{source:e.connection,target:e.target}])})},className:"w-full",children:"Apply Filters"})]})})]}),!s&&(0,n.jsx)(m,{variant:"outline",size:"icon",className:"fixed top-4 left-4 z-40",onClick:S,children:(0,n.jsx)(l.Z,{className:"h-4 w-4"})}),(0,n.jsxs)("div",{className:"jsx-869851c74c19e9a9 fixed top-4 right-4 z-40 flex space-x-2",children:[(0,n.jsx)(m,{variant:"outline",size:"icon",onClick:()=>P("in"),children:(0,n.jsx)(d.Z,{className:"h-4 w-4"})}),(0,n.jsx)(m,{variant:"outline",size:"icon",onClick:()=>P("out"),children:(0,n.jsx)(u.Z,{className:"h-4 w-4"})})]}),(0,n.jsx)(a(),{id:"869851c74c19e9a9",children:"html,body{margin:0;padding:0;overflow:hidden}#__next{width:100vw;height:100vh}.link{stroke-opacity:.6}.node text{font-size:10px;fill:white}.node circle{stroke:#fff;stroke-width:2px}.connection-node{fill:#ffd700;stroke:#ff8c00;stroke-width:2px}"})]})};function P(){return(0,n.jsxs)("div",{className:"container mx-auto",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Network Visualization"}),(0,n.jsx)(S,{})]})}},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},Zb:function(){return o},aY:function(){return l},ll:function(){return c}});var n=r(7437),s=r(2265),a=r(4508);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});l.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},6815:function(e,t,r){"use strict";r.d(t,{Label:function(){return l}});var n=r(7437),s=r(2265),a=r(6394),o=r(7712),i=r(4508);let c=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)(a.f,{ref:t,className:(0,i.cn)(c(),r),...s})});l.displayName=a.f.displayName},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(1994),s=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}}},function(e){e.O(0,[310,681,159,971,117,744],function(){return e(e.s=1490)}),_N_E=e.O()}]);